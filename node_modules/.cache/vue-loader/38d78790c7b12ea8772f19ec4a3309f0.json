{"remainingRequest":"/home/aline/AstaPrecifique/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/aline/AstaPrecifique/src/views/Product/ProductCreateOrEditImages.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/aline/AstaPrecifique/src/views/Product/ProductCreateOrEditImages.vue","mtime":1673321154842},{"path":"/home/aline/AstaPrecifique/node_modules/cache-loader/dist/cjs.js","mtime":1673370377252},{"path":"/home/aline/AstaPrecifique/node_modules/babel-loader/lib/index.js","mtime":1673370377198},{"path":"/home/aline/AstaPrecifique/node_modules/ts-loader/index.js","mtime":1673370387800},{"path":"/home/aline/AstaPrecifique/node_modules/cache-loader/dist/cjs.js","mtime":1673370377252},{"path":"/home/aline/AstaPrecifique/node_modules/vue-loader/lib/index.js","mtime":1673370389594}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCBWdWUgZnJvbSAndnVlJzsKCmltcG9ydCBQcm9kdWN0Q3JlYXRlT3JFZGl0U3RlcCBmcm9tICJAL3ZpZXdzL1Byb2R1Y3QvUHJvZHVjdENyZWF0ZU9yRWRpdFN0ZXAudnVlIjsKaW1wb3J0IFByb2R1Y3RJbWFnZUNhcm91c2VsIGZyb20gIkAvY29tcG9uZW50cy9wcm9kdWN0LW1vZGFsL3Byb2R1Y3QtaW1hZ2UtY2Fyb3VzZWwvUHJvZHVjdEltYWdlQ2Fyb3VzZWwudnVlIjsKaW1wb3J0IFByb2R1Y3RMb2FkaW5nU2NyZWVuIGZyb20gIkAvY29tcG9uZW50cy9wcm9kdWN0LW1vZGFsL3Byb2R1Y3QtbG9hZGluZy1zY3JlZW4vUHJvZHVjdExvYWRpbmdTY3JlZW4udnVlIjsKaW1wb3J0IFByb2R1Y3RJbWFnZUNyb3BwZXIgZnJvbSAiQC9jb21wb25lbnRzL3Byb2R1Y3QtbW9kYWwvcHJvZHVjdC1pbWFnZS1jcm9wcGVyL1Byb2R1Y3RJbWFnZUNyb3BwZXIudnVlIjsKCgppbXBvcnQgQ29tcHJlc3NvciBmcm9tICJjb21wcmVzc29yanMiOwppbXBvcnQgcHJvZHVjdHNTZXJ2aWNlIGZyb20gIkAvc2VydmljZXMvcHJvZHVjdHMuc2VydmljZSI7CgppbnRlcmZhY2UgSURhdGEgewogIGltYWdlVG9Dcm9wOiBCbG9iIHwgRmlsZSB8IHN0cmluZyB8IG51bGw7CiAgaW1hZ2VMaXN0OiBhbnlbXTsKICBvcGVuTG9hZGluZ1NjcmVlbjogYm9vbGVhbjsKICBwcm9kdWN0TG9hZGluZzogYm9vbGVhbjsKICBwcm9kdWN0c1NlcnZpY2U6IHByb2R1Y3RzU2VydmljZSwKICBvcGVuSW1hZ2VDcm9wcGVyOiBib29sZWFuOwogIGltYWdlVG9Dcm9wUG9zaXRpb246IG51bWJlciB8IG51bGw7Cn0KCmV4cG9ydCBkZWZhdWx0IFZ1ZS5leHRlbmQoewogIG5hbWU6ICJQcm9kdWN0Q3JlYXRlT3JFZGl0SW1hZ2VzIiwKICBjb21wb25lbnRzOiB7CiAgICBQcm9kdWN0SW1hZ2VDcm9wcGVyLAogICAgUHJvZHVjdExvYWRpbmdTY3JlZW4sCiAgICBQcm9kdWN0SW1hZ2VDYXJvdXNlbCwKICAgIFByb2R1Y3RDcmVhdGVPckVkaXRTdGVwLAogIH0sCgogIHByb3BzOiB7CiAgICBvcGVuOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICB9LAoKICAgIHByb2R1Y3RHdWlkOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgIH0sCgogICAgaXNTZXJ2aWNlOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6ICgpID0+IGZhbHNlLAogICAgfSwKCiAgICBpc1VwZGF0ZVBhZ2U6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogKCkgPT4gZmFsc2UsCiAgICB9LAoKICAgIHByb2R1Y3Q6IHsKICAgICAgdHlwZTogW09iamVjdCwgQm9vbGVhbl0sCiAgICAgIGRlZmF1bHQ6ICgpID0+IGZhbHNlLAogICAgfQogIH0sCgogIGRhdGEoKTogSURhdGEgewogICAgcmV0dXJuIHsKICAgICAgaW1hZ2VUb0Nyb3BQb3NpdGlvbjogbnVsbCwKICAgICAgaW1hZ2VUb0Nyb3A6IG51bGwsCiAgICAgIGltYWdlTGlzdDogW10sCgogICAgICBvcGVuTG9hZGluZ1NjcmVlbjogZmFsc2UsCiAgICAgIHByb2R1Y3RMb2FkaW5nOiBmYWxzZSwKICAgICAgcHJvZHVjdHNTZXJ2aWNlOiBuZXcgcHJvZHVjdHNTZXJ2aWNlKCksCiAgICAgIG9wZW5JbWFnZUNyb3BwZXI6IGZhbHNlLAogICAgfQogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBzdGVwVGl0bGUoKTogc3RyaW5nIHsKICAgICAgcmV0dXJuIHRoaXMuaXNVcGRhdGVQYWdlCiAgICAgICAgPyBgRm90b3MgZG8gJHt0aGlzLmlzU2VydmljZSA/ICdzZXJ2acOnbycgOiAncHJvZHV0byd9YAogICAgICAgIDogYE1lbGhvcmUgc2V1IGFuw7puY2lvIGNvbSBmb3RvcyBkbyBzZXUgJHt0aGlzLmlzU2VydmljZSA/ICdzZXJ2acOnbycgOiAncHJvZHV0byd9YAogICAgfQogIH0sCgogIGNyZWF0ZWQoKSB7CiAgICBpZiAodGhpcy5wcm9kdWN0KSB7CiAgICAgIHRoaXMuaW1hZ2VMaXN0ID0gdGhpcy5wcm9kdWN0LmltYWdlX2xpc3Q7CiAgICB9CiAgfSwKCiAgbWV0aG9kczogewogICAgYWRkSW1hZ2UoKSB7CiAgICAgICh0aGlzLiRyZWZzLmltYWdlSW5wdXQgYXMgSFRNTElucHV0RWxlbWVudCkuY2xpY2soKTsKICAgIH0sCgogICAgZGVsZXRlSW1hZ2UoaW5kZXgpIHsKICAgICAgdGhpcy5pbWFnZUxpc3Quc3BsaWNlKGluZGV4LCAxKTsKICAgIH0sCgogICAgY3JvcEltYWdlKGluZGV4KSB7CiAgICAgIGNvbnN0IGltYWdlID0gdGhpcy5pbWFnZUxpc3RbaW5kZXhdOwogICAgICB0aGlzLmltYWdlVG9Dcm9wID0gaW1hZ2UuaW1hZ2VfdXJsOwogICAgICB0aGlzLmltYWdlVG9Dcm9wUG9zaXRpb24gPSBpbmRleDsKCiAgICAgIHRoaXMub3BlbkltYWdlQ3JvcHBlciA9IHRydWU7CiAgICB9LAoKICAgIGNsb3NlSW1hZ2VDcm9wcGVyKFttZXNzYWdlLCBpbWFnZV0pIHsKICAgICAgaWYgKG1lc3NhZ2UgPT09ICdzdWNjZXNzJykgewogICAgICAgIHRoaXMuJHNldCh0aGlzLmltYWdlTGlzdCwgaW1hZ2UucG9zaXRpb24sIHsKICAgICAgICAgIC4uLnRoaXMuaW1hZ2VMaXN0W2ltYWdlLnBvc2l0aW9uXSwKICAgICAgICAgIGltYWdlX3VybDogaW1hZ2UuaW1hZ2VfdXJsLAogICAgICAgICAgaW1hZ2VCbG9iOiBpbWFnZS5pbWFnZUZpbGUsCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMub3BlbkltYWdlQ3JvcHBlciA9IGZhbHNlOwogICAgICB0aGlzLmltYWdlVG9Dcm9wID0gbnVsbDsKICAgICAgdGhpcy5pbWFnZVRvQ3JvcFBvc2l0aW9uID0gbnVsbDsKICAgIH0sCgogICAgb25VcGxvYWRQcm9ncmVzcyhldmVudCwgaW5kZXgpIHsKICAgICAgbGV0IHByb2dyZXNzOiBudW1iZXIgPSBNYXRoLnJvdW5kKAogICAgICAgIChldmVudC5sb2FkZWQgKiAxMDApIC8gZXZlbnQudG90YWwKICAgICAgKTsKCiAgICAgIGlmICh0aGlzLmltYWdlTGlzdCAmJiB0aGlzLmltYWdlTGlzdCkgewogICAgICAgIHRoaXMuJHNldCh0aGlzLmltYWdlTGlzdCwgaW5kZXgsIHsKICAgICAgICAgIC4uLnRoaXMuaW1hZ2VMaXN0W2luZGV4XSwKICAgICAgICAgIHVwbG9hZFByb2dyZXNzOiBwcm9ncmVzcywKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKCiAgICBzZW5kSW1hZ2VUb1MzKHBhcmFtcykgewogICAgICByZXR1cm4gdGhpcy5wcm9kdWN0c1NlcnZpY2UudXBsb2FkVG9TMyh7CiAgICAgICAgLi4ucGFyYW1zLAogICAgICB9KTsKICAgIH0sCgogICAgZ2V0U2lnbmF0dXJlcyhxdWFudGl0eSkgewogICAgICByZXR1cm4gdGhpcy5wcm9kdWN0c1NlcnZpY2UuZ2V0UzNTaWduYXR1cmUodGhpcy5wcm9kdWN0R3VpZCwgcXVhbnRpdHkpOwogICAgfSwKCiAgICBkZWxheShtcykgewogICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlcykgPT4gc2V0VGltZW91dChyZXMsIG1zKSk7CiAgICB9LAoKICAgIHNraXAoKSB7CiAgICAgIHRoaXMuJGVtaXQoJ2NvbmZpcm0tbGVhdmUnLCB0cnVlKTsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9wcm9kdXRvcycpOwogICAgfSwKCiAgICBhc3luYyB1cGRhdGVQcm9kdWN0SW1hZ2VzKCkgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IG9sZEltYWdlcyA9IHRoaXMuaW1hZ2VMaXN0LmZpbHRlcihpbWFnZSA9PiAhaW1hZ2UuaXNOZXcpOwogICAgICAgIGNvbnN0IGltYWdlc1RvVXBsb2FkID0gdGhpcy5pbWFnZUxpc3QuZmlsdGVyKGltYWdlID0+IGltYWdlLmlzTmV3KTsKCiAgICAgICAgbGV0IHNpZ25hdHVyZXMgPSBbXSBhcyBhbnlbXTsKCiAgICAgICAgaWYgKGltYWdlc1RvVXBsb2FkLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgdGhpcy5nZXRTaWduYXR1cmVzKGltYWdlc1RvVXBsb2FkLmxlbmd0aCk7CgogICAgICAgICAgc2lnbmF0dXJlcyA9IGRhdGE7CgogICAgICAgICAgdGhpcy5vcGVuTG9hZGluZ1NjcmVlbiA9IHRydWU7CgogICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKAogICAgICAgICAgICBpbWFnZXNUb1VwbG9hZC5tYXAoKGltYWdlLCBpbmRleCkgPT4gewogICAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbmRJbWFnZVRvUzMoewogICAgICAgICAgICAgICAgLi4uc2lnbmF0dXJlc1tpbmRleF0uY29kZSwKICAgICAgICAgICAgICAgIGltYWdlOiBpbWFnZS5pbWFnZUJsb2IsCiAgICAgICAgICAgICAgICBvblVwbG9hZFByb2dyZXNzQ2FsbGJhY2s6IHRoaXMub25VcGxvYWRQcm9ncmVzcywKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBpbmRleCwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSksCiAgICAgICAgICApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnByb2R1Y3RMb2FkaW5nID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHRoaXMuaW1hZ2VMaXN0LmZvckVhY2goaW1hZ2UgPT4gaW1hZ2UuaXNOZXcgPSBmYWxzZSkKCiAgICAgICAgYXdhaXQgdGhpcy5wcm9kdWN0c1NlcnZpY2UudXBkYXRlUHJvZHVjdEltYWdlcygKICAgICAgICAgIHRoaXMucHJvZHVjdEd1aWQsCiAgICAgICAgICBbCiAgICAgICAgICAgIC4uLmltYWdlc1RvVXBsb2FkLm1hcCgoaW1hZ2UsIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgY29uc3Qgc2lnbmF0dXJlID0gc2lnbmF0dXJlc1tpbmRleF0uY29kZTsKICAgICAgICAgICAgICByZXR1cm4gc2lnbmF0dXJlLnVybCArIHNpZ25hdHVyZS5maWVsZHMua2V5OwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgLi4ub2xkSW1hZ2VzLm1hcChpbWFnZSA9PiBpbWFnZS5pbWFnZV91cmwpLAogICAgICAgICAgXQogICAgICAgICk7CgogICAgICAgIHRoaXMucHJvZHVjdExvYWRpbmcgPSB0cnVlOwoKICAgICAgICB0aGlzLm9wZW5Mb2FkaW5nU2NyZWVuID0gZmFsc2U7CgogICAgICAgIGF3YWl0IHRoaXMuZGVsYXkoNTAwKTsKCiAgICAgICAgdGhpcy4kZW1pdCgnY29uZmlybS1sZWF2ZScsIHRydWUpOwogICAgICAgIGF3YWl0IHRoaXMuJHJvdXRlci5wdXNoKCcvcHJvZHV0b3MnKTsKCiAgICAgICAgYXdhaXQgdGhpcy4kYWxlcnQoCiAgICAgICAgICBgSW1hZ2VucyAke3RoaXMuaXNVcGRhdGVQYWdlID8gJ2F0dWFsaXphZGFzJyA6ICdhZGljaW9uYWRhcyd9IGNvbSBzdWNlc3NvYCwKICAgICAgICAgICcnLAogICAgICAgICAgJ3N1Y2Nlc3MnLCB7CiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAndG9wLWVuZCcsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMzAwMCwKICAgICAgICB9KTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7CgogICAgICAgIGF3YWl0IHRoaXMuJGFsZXJ0KCdFcnJvIGFvIGZhemVyIG8gdXBsb2FkIGRhcyBpbWFnZW5zJywgJycsICdlcnJvcicsIHsKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICd0b3AtZW5kJywKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAzMDAwLAogICAgICAgIH0pOwogICAgICB9CgogICAgICB0aGlzLm9wZW5Mb2FkaW5nU2NyZWVuID0gZmFsc2U7CiAgICB9LAoKICAgIG9uSW1hZ2VJbnB1dChlKSB7CiAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHRoaXMuJHJlZnMuaW1hZ2VJbnB1dCBhcyBIVE1MSW5wdXRFbGVtZW50IHx8IHt9OwoKICAgICAgaWYgKGZpbGVJbnB1dCAmJiBmaWxlSW5wdXQuZmlsZXMhLmxlbmd0aCkgewogICAgICAgIGxldCBpbWFnZUZpbGU6IEJsb2IgfCBGaWxlID0gZmlsZUlucHV0LmZpbGVzIVswXTsKICAgICAgICBpZiAoaW1hZ2VGaWxlLnNpemUgLyAxMDAwMDAwIDwgMTUpIHsKICAgICAgICAgIGNvbnN0IGNvbXByZXNzb3IgPSBuZXcgQ29tcHJlc3NvcihpbWFnZUZpbGUsIHsKICAgICAgICAgICAgcXVhbGl0eTogMC41LAogICAgICAgICAgICB3aWR0aDogMTI1MCwKICAgICAgICAgICAgaGVpZ2h0OiAxMjUwLAogICAgICAgICAgICBjb252ZXJ0U2l6ZTogMCwKICAgICAgICAgICAgc3VjY2VzczogYXN5bmMgKGltYWdlQ29tcHJlc3NlZCkgPT4gewogICAgICAgICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAgICAgaWYgKGltYWdlQ29tcHJlc3NlZC5zaXplIC8gMTAwMDAwMCA8IDYpIHsKICAgICAgICAgICAgICAgIGltYWdlRmlsZSA9IGltYWdlQ29tcHJlc3NlZDsKICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGltYWdlQ29tcHJlc3NlZCk7CiAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gYXN5bmMgKGU6IGFueSkgPT4gewogICAgICAgICAgICAgICAgICB0aGlzLmltYWdlTGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgICBpbWFnZV91cmw6IGUudGFyZ2V0LnJlc3VsdCwKICAgICAgICAgICAgICAgICAgICBpbWFnZUJsb2I6IGF3YWl0IChhd2FpdCBmZXRjaChlLnRhcmdldC5yZXN1bHQpKS5ibG9iKCksCiAgICAgICAgICAgICAgICAgICAgaXNOZXc6IHRydWUsCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB0aGlzLmltYWdlVG9Dcm9wID0gZS50YXJnZXQucmVzdWx0OwogICAgICAgICAgICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICAgICAgICAgICAgZmlsZUlucHV0LnZhbHVlID0gbnVsbDsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGFsZXJ0KCJSZWR1emEgbyB0YW1hbmhvIGRlIGltYWdlbSBlIHRlbnRlIG5vdmFtZW50ZS4iKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGVycm9yKGVycikgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJlcnJvIGNvbXByaW1pbmRvIGltYWdlbSIsIGVyci5tZXNzYWdlKTsKICAgICAgICAgICAgfSwKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhbGVydCgiUmVkdXphIG8gdGFtYW5obyBkZSBpbWFnZW0gZSB0ZW50ZSBub3ZhbWVudGUuIik7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQp9KTsK"},{"version":3,"sources":["ProductCreateOrEditImages.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProductCreateOrEditImages.vue","sourceRoot":"src/views/Product","sourcesContent":["<template>\n  <product-create-or-edit-step :step=\"2\" :open=\"open\" :title=\"stepTitle\" @header-click=\"$emit('header-click')\"\n    :hide-steps=\"isUpdatePage\">\n    <div class=\"product-create-or-edit-images p-1 px-md-4\">\n      <div class=\"product-create-or-edit-images__info d-flex align-items-center p-1 mb-4 mx-auto\">\n        <span class=\"material-icons mr-2\">\n          info\n        </span>\n        <span class=\"product-create-or-edit-images__text\">\n          Seu {{ isService ? 'serviço' : 'produto' }} já foi criado e está disponivel na sua vitrine, adicione imagens\n          para melhorar sua exposição na plataforma e atrair mais clientes para o seu negócio.\n        </span>\n      </div>\n\n      <input ref=\"imageInput\" accept=\".jpg,.jpeg,.png\" @input=\"onImageInput\" type=\"file\" style=\"display: none\">\n\n      <product-image-carousel class=\"mb-3\" v-model=\"imageList\" @delete-click=\"deleteImage\" @crop-click=\"cropImage\"\n        @add-click=\"addImage\" />\n\n      <div class=\"product-create-or-edit-images__image-specs\">\n        <ul>\n          <li>\n            {{\n            isService ? 'Certifique-se que as imagem demonstre o serviço oferecido' : 'Certifique-se que o produto\n            esteja visível'\n            }}\n          </li>\n          <li>\n            Tamanho máximo 6MB\n          </li>\n          <li>\n            Dimensões ideais: 600x600\n          </li>\n          <li>\n            Formatos permitidos: PNG/JPG/JPEG\n          </li>\n        </ul>\n      </div>\n\n      <div class=\"d-flex align-items-center mt-3\"\n        :class=\"isUpdatePage ? 'justify-content-end' : 'justify-content-between'\">\n        <button v-if=\"!isUpdatePage\" class=\"btn btn-link d-flex align-items-center p-0\" @click=\"$emit('back')\">\n          <span class=\"material-icons\">chevron_left</span>\n          Voltar\n        </button>\n\n        <div class=\"d-flex align-items-center\">\n          <button v-if=\"!isUpdatePage\" class=\"btn btn-outline-primary mr-1 mr-sm-2\" @click=\"skip\">\n            Pular\n          </button>\n\n          <button class=\"btn btn-primary\" @click=\"updateProductImages\">\n            Salvar imagens\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <product-image-cropper v-if=\"openImageCropper\" :propShowCropperImage=\"openImageCropper\"\n      :prop-image-to-crop=\"imageToCrop\" :prop-product-guid=\"productGuid\" :prop-position=\"imageToCropPosition\"\n      :propDescription=\"''\" v-on:closeCropperImageModal=\"closeImageCropper\" />\n\n    <product-loading-screen v-if=\"openLoadingScreen\" :image-list=\"imageList\" :creating-product=\"productLoading\" />\n  </product-create-or-edit-step>\n</template>\n\n<script lang=\"ts\">\nimport Vue from 'vue';\n\nimport ProductCreateOrEditStep from \"@/views/Product/ProductCreateOrEditStep.vue\";\nimport ProductImageCarousel from \"@/components/product-modal/product-image-carousel/ProductImageCarousel.vue\";\nimport ProductLoadingScreen from \"@/components/product-modal/product-loading-screen/ProductLoadingScreen.vue\";\nimport ProductImageCropper from \"@/components/product-modal/product-image-cropper/ProductImageCropper.vue\";\n\n\nimport Compressor from \"compressorjs\";\nimport productsService from \"@/services/products.service\";\n\ninterface IData {\n  imageToCrop: Blob | File | string | null;\n  imageList: any[];\n  openLoadingScreen: boolean;\n  productLoading: boolean;\n  productsService: productsService,\n  openImageCropper: boolean;\n  imageToCropPosition: number | null;\n}\n\nexport default Vue.extend({\n  name: \"ProductCreateOrEditImages\",\n  components: {\n    ProductImageCropper,\n    ProductLoadingScreen,\n    ProductImageCarousel,\n    ProductCreateOrEditStep,\n  },\n\n  props: {\n    open: {\n      type: Boolean,\n    },\n\n    productGuid: {\n      type: String,\n    },\n\n    isService: {\n      type: Boolean,\n      default: () => false,\n    },\n\n    isUpdatePage: {\n      type: Boolean,\n      default: () => false,\n    },\n\n    product: {\n      type: [Object, Boolean],\n      default: () => false,\n    }\n  },\n\n  data(): IData {\n    return {\n      imageToCropPosition: null,\n      imageToCrop: null,\n      imageList: [],\n\n      openLoadingScreen: false,\n      productLoading: false,\n      productsService: new productsService(),\n      openImageCropper: false,\n    }\n  },\n\n  computed: {\n    stepTitle(): string {\n      return this.isUpdatePage\n        ? `Fotos do ${this.isService ? 'serviço' : 'produto'}`\n        : `Melhore seu anúncio com fotos do seu ${this.isService ? 'serviço' : 'produto'}`\n    }\n  },\n\n  created() {\n    if (this.product) {\n      this.imageList = this.product.image_list;\n    }\n  },\n\n  methods: {\n    addImage() {\n      (this.$refs.imageInput as HTMLInputElement).click();\n    },\n\n    deleteImage(index) {\n      this.imageList.splice(index, 1);\n    },\n\n    cropImage(index) {\n      const image = this.imageList[index];\n      this.imageToCrop = image.image_url;\n      this.imageToCropPosition = index;\n\n      this.openImageCropper = true;\n    },\n\n    closeImageCropper([message, image]) {\n      if (message === 'success') {\n        this.$set(this.imageList, image.position, {\n          ...this.imageList[image.position],\n          image_url: image.image_url,\n          imageBlob: image.imageFile,\n        });\n      }\n\n      this.openImageCropper = false;\n      this.imageToCrop = null;\n      this.imageToCropPosition = null;\n    },\n\n    onUploadProgress(event, index) {\n      let progress: number = Math.round(\n        (event.loaded * 100) / event.total\n      );\n\n      if (this.imageList && this.imageList) {\n        this.$set(this.imageList, index, {\n          ...this.imageList[index],\n          uploadProgress: progress,\n        });\n      }\n    },\n\n    sendImageToS3(params) {\n      return this.productsService.uploadToS3({\n        ...params,\n      });\n    },\n\n    getSignatures(quantity) {\n      return this.productsService.getS3Signature(this.productGuid, quantity);\n    },\n\n    delay(ms) {\n      return new Promise((res) => setTimeout(res, ms));\n    },\n\n    skip() {\n      this.$emit('confirm-leave', true);\n      this.$router.push('/produtos');\n    },\n\n    async updateProductImages() {\n      try {\n        const oldImages = this.imageList.filter(image => !image.isNew);\n        const imagesToUpload = this.imageList.filter(image => image.isNew);\n\n        let signatures = [] as any[];\n\n        if (imagesToUpload.length > 0) {\n          const { data } = await this.getSignatures(imagesToUpload.length);\n\n          signatures = data;\n\n          this.openLoadingScreen = true;\n\n          const result = await Promise.allSettled(\n            imagesToUpload.map((image, index) => {\n              return this.sendImageToS3({\n                ...signatures[index].code,\n                image: image.imageBlob,\n                onUploadProgressCallback: this.onUploadProgress,\n                position: index,\n              });\n            }),\n          );\n        } else {\n          this.productLoading = true;\n        }\n\n        this.imageList.forEach(image => image.isNew = false)\n\n        await this.productsService.updateProductImages(\n          this.productGuid,\n          [\n            ...imagesToUpload.map((image, index) => {\n              const signature = signatures[index].code;\n              return signature.url + signature.fields.key;\n            }),\n            ...oldImages.map(image => image.image_url),\n          ]\n        );\n\n        this.productLoading = true;\n\n        this.openLoadingScreen = false;\n\n        await this.delay(500);\n\n        this.$emit('confirm-leave', true);\n        await this.$router.push('/produtos');\n\n        await this.$alert(\n          `Imagens ${this.isUpdatePage ? 'atualizadas' : 'adicionadas'} com sucesso`,\n          '',\n          'success', {\n          toast: true,\n          position: 'top-end',\n          showConfirmButton: false,\n          timer: 3000,\n        });\n      } catch (e) {\n        console.error(e);\n\n        await this.$alert('Erro ao fazer o upload das imagens', '', 'error', {\n          toast: true,\n          position: 'top-end',\n          showConfirmButton: false,\n          timer: 3000,\n        });\n      }\n\n      this.openLoadingScreen = false;\n    },\n\n    onImageInput(e) {\n      const fileInput = this.$refs.imageInput as HTMLInputElement || {};\n\n      if (fileInput && fileInput.files!.length) {\n        let imageFile: Blob | File = fileInput.files![0];\n        if (imageFile.size / 1000000 < 15) {\n          const compressor = new Compressor(imageFile, {\n            quality: 0.5,\n            width: 1250,\n            height: 1250,\n            convertSize: 0,\n            success: async (imageCompressed) => {\n              const reader = new FileReader();\n              if (imageCompressed.size / 1000000 < 6) {\n                imageFile = imageCompressed;\n                reader.readAsDataURL(imageCompressed);\n                reader.onload = async (e: any) => {\n                  this.imageList.push({\n                    image_url: e.target.result,\n                    imageBlob: await (await fetch(e.target.result)).blob(),\n                    isNew: true,\n                  });\n                  this.imageToCrop = e.target.result;\n                  //@ts-ignore\n                  fileInput.value = null;\n                };\n              } else {\n                alert(\"Reduza o tamanho de imagem e tente novamente.\");\n              }\n            },\n            error(err) {\n              console.log(\"erro comprimindo imagem\", err.message);\n            },\n          });\n        } else {\n          alert(\"Reduza o tamanho de imagem e tente novamente.\");\n        }\n      }\n    }\n  }\n});\n</script>\n\n<style scoped lang=\"scss\">\n.product-create-or-edit-images {\n  &__info {\n    width: 100%;\n    max-width: 527px;\n\n    background-color: rgba(0, 0, 0, 0.05);\n    box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.1);\n\n    border-radius: 1px 3px 3px 1px;\n    border-left: 2px solid $primary;\n\n    font-size: .75rem;\n\n    line-height: 1;\n\n    text-align: justify;\n\n    span.material-icons {\n      color: $primary;\n    }\n\n    &__text {\n      color: rgba(0, 0, 0, 0.8);\n    }\n  }\n\n  &__image-specs {\n    li {\n      font-size: 0.75rem !important;\n      color: rgba(0, 0, 0, 0.8);\n    }\n  }\n}\n</style>"]}]}